# 📊 CSV数据导入指南

## 🎯 概述

本指南将帮助您通过CSV文件批量导入价格数据到MongoDB数据库中。

## 📋 CSV文件格式要求

### 必需的列（按顺序）：

| 列名 | 类型 | 说明 | 示例 |
|------|------|------|------|
| `category` | 文本 | 产品类别 | cabinet, doorPanel, wallpanel |
| `id` | 文本 | 唯一标识符 | cab_001, door_001 |
| `name` | 文本 | 产品名称 | 标准密度板 18mm |
| `brand` | 文本 | 品牌名称 | 乐山家具 |
| `price` | 数字 | 价格（不含单位） | 280, 1200 |
| `unit` | 文本 | 价格单位 | 元/㎡, 元/樘, 元/米 |
| `description` | 文本 | 产品描述 | 标准密度板适用于一般柜体制作 |
| `specifications` | 文本 | 产品规格 | 厚度18mm材质密度板表面双面贴纸 |

### 支持的产品类别：

- `cabinet` - 柜体板材
- `doorPanel` - 柜门板材  
- `wallpanel` - 墙板护墙板
- `door` - 室内门
- `column` - 罗马柱
- `lighting` - 灯光灯带
- `stone` - 石材岩板
- `island` - 橱柜岛台
- `baseboard` - 踢脚线
- `hardware` - 五金配件
- `glass` - 玻璃材料

## 📄 CSV模板文件

系统已为您准备了一个完整的CSV模板文件：`price_template.csv`

### 模板特点：
- ✅ **完整示例数据** - 包含所有产品类别的示例
- ✅ **正确格式** - 严格按照系统要求的格式
- ✅ **中文支持** - 完全支持中文产品名称和描述
- ✅ **品牌一致** - 所有产品统一使用"乐山家具"品牌

### 使用模板：
1. 复制 `price_template.csv` 文件
2. 根据您的实际产品修改数据
3. 保存为新的CSV文件
4. 使用导入命令导入数据

## 🚀 导入方法

### 方法1：使用模板文件导入
```bash
# 直接导入模板数据
node import-csv.js price_template.csv
```

### 方法2：导入自定义CSV文件
```bash
# 导入您自己的CSV文件
node import-csv.js 您的文件名.csv

# 示例
node import-csv.js my_prices.csv
node import-csv.js ./data/furniture_prices.csv
```

### 方法3：使用npm脚本
```bash
# 添加到package.json后可以这样使用
npm run import-csv price_template.csv
```

## 📝 CSV文件编写注意事项

### 1. 编码格式
- **必须使用UTF-8编码**，确保中文正常显示
- 推荐使用Excel另存为CSV(UTF-8)格式

### 2. 字段格式
- **价格字段**：只填写数字，不要包含"元"或其他符号
- **ID字段**：确保唯一性，建议使用前缀+数字格式
- **类别字段**：必须使用指定的英文类别名

### 3. 特殊字符处理
- 如果描述中包含逗号，请用双引号包围整个字段
- 示例：`"高密度板，适用于承重柜体，质量优良"`

### 4. 数据验证
- **必填字段**：category, id, name, brand, price, unit
- **可选字段**：description, specifications
- **价格必须为正数**

## 🔧 导入过程说明

### 导入步骤：
1. **文件检查** - 验证CSV文件是否存在
2. **数据解析** - 解析CSV内容并验证格式
3. **数据预览** - 显示前3条数据供确认
4. **用户确认** - 询问是否继续导入
5. **清空旧数据** - 删除现有价格数据
6. **批量导入** - 插入新数据到MongoDB
7. **创建索引** - 优化查询性能
8. **统计报告** - 显示导入结果统计

### 导入日志示例：
```
📊 乐山家具定制系统 - CSV数据导入工具
================================================

🔗 连接到MongoDB Atlas...
✅ MongoDB连接成功！
📄 CSV文件读取成功
📊 解析到 48 条数据

📋 数据预览（前3条）:
1. cabinet - 标准密度板 18mm - ¥280元/㎡
2. cabinet - 高密度板 18mm - ¥320元/㎡
3. cabinet - 实木颗粒板 18mm - ¥350元/㎡

❓ 是否继续导入这些数据？(y/N): y
🗑️  清空了 0 条旧数据
🎉 成功导入 48 条价格数据！
🔍 索引创建完成

📈 导入数据统计:
  baseboard: 4条, 均价¥50, 区间¥35-¥65
  cabinet: 6条, 均价¥355, 区间¥280-¥480
  column: 4条, 均价¥430, 区间¥180-¥680
  ...
```

## ⚠️ 常见问题解决

### 1. 编码问题
**问题**：中文显示为乱码
**解决**：确保CSV文件使用UTF-8编码保存

### 2. 格式错误
**问题**：导入失败，数据格式错误
**解决**：检查CSV文件是否严格按照模板格式

### 3. 重复ID
**问题**：ID重复导致导入失败
**解决**：确保每个产品的ID都是唯一的

### 4. 价格格式
**问题**：价格字段包含非数字字符
**解决**：价格字段只能包含数字，单位在unit字段中

## 📊 数据管理建议

### 1. 备份策略
- 导入前备份现有数据
- 保留原始CSV文件作为数据源

### 2. 版本控制
- 为CSV文件添加版本号
- 记录每次导入的时间和变更内容

### 3. 数据验证
- 导入后检查数据完整性
- 测试前端系统是否正常显示

## 🎉 导入完成后

导入成功后，您可以：

1. **启动系统**：`npm start`
2. **访问前端**：http://localhost:3000
3. **检查API**：http://localhost:3000/api/prices
4. **测试功能**：在前端界面测试价格数据加载

---

**现在您可以轻松地通过CSV文件管理乐山家具定制系统的价格数据了！** 📊✨
